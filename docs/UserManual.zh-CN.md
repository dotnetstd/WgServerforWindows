# Wg Server for Windows 使用手册

欢迎使用 **Wg Server for Windows (WS4W)**！本手册将帮助您快速上手、配置并管理您的 WireGuard 服务端。

## 目录
1. [简介](#1-简介)
2. [安装与启动](#2-安装与启动)
3. [界面概览](#3-界面概览)
4. [服务器配置](#4-服务器配置)
5. [客户端配置](#5-客户端配置)
6. [高级功能](#6-高级功能)
7. [常见问题](#7-常见问题)

---

## 1. 简介
**Wg Server for Windows** 是一款专为 Windows 设计的桌面应用程序，旨在简化 WireGuard 服务端的部署与管理。它无需复杂的命令行操作，通过现代化的图形界面即可完成 NAT 路由、Internet 共享、端口转发等配置。

### 核心特性
*   **开箱即用**：自动检测并安装 WireGuard 依赖。
*   **可视化管理**：直观的仪表盘，实时监控网络状态与流量。
*   **多语言支持**：支持简体中文与英文界面切换。
*   **智能辅助**：内置 MTU 优化向导、动态 IP 同步等实用工具。

---

## 2. 安装与启动
1.  下载最新版本的安装包 (`.msi` 或 `.exe`)。
2.  运行安装程序并按照提示完成安装。
3.  启动应用程序。
    *   **注意**：程序需要管理员权限才能管理网络服务，请在 UAC 提示时选择“是”。
4.  首次启动时，程序会自动检测环境（如 WireGuard.exe 是否存在），并引导您完成必要组件的安装。

---

## 3. 界面概览
程序界面采用现代化的侧边栏设计，主要分为以下几个区域：

### 仪表盘 (Dashboard)
*   **网络状态**：显示当前的公网 IP (IPv6/IPv4)。
*   **流量监控**：实时展示上传与下载速率。
*   **快捷操作**：
    *   `MTU 优化器`：检测最佳 MTU 值以提升网络性能。
    *   `复制`：一键复制公网 IP。
    *   `刷新`：手动更新网络状态。

### 隧道 (Tunnels)
*   核心配置区域，包含服务器与客户端的所有设置。
*   通过红/绿状态指示器，直观展示各项服务（如隧道服务、NAT 路由）是否正常运行。

### 日志 (Logs)
*   查看 WireGuard 服务端的运行日志。
*   支持自动刷新，方便排查连接问题。

### 设置 (Settings)
*   **语言切换**：在中文与英文之间切换。
*   **自动化设置**：启用/禁用动态 IP 同步等后台任务。
*   **启动延时**：设置开机自启任务的延迟时间，避免网络未就绪导致服务启动失败。

---

## 4. 服务器配置
在“隧道”页面中，您可以完成服务器端的关键配置：

1.  **服务器配置文件**：
    *   程序会自动在 `Data` 目录下生成 `server_config`。
    *   您可以点击“打开服务器配置目录”手动查看或备份。
2.  **网络地址转换 (NAT)**：
    *   WS4W 支持两种 NAT 模式：
        *   **NAT 路由 (推荐)**：性能更好，支持更复杂的网络拓扑。
        *   **Internet 连接共享 (ICS)**：Windows 原生功能，兼容性较好。
    *   根据向导提示，点击“启用 NAT”即可。
3.  **私钥与公钥**：
    *   程序会自动生成，通常无需手动修改。
4.  **监听端口**：
    *   默认为 `51820`。请确保您的路由器已将该 UDP 端口转发到此电脑。

---

## 5. 客户端配置
添加并管理连接到服务器的设备（手机、笔记本等）：

1.  点击“添加客户端”按钮。
2.  输入客户端名称（如 `MyPhone`）。
3.  **自动生成配置**：
    *   私钥/公钥会自动生成。
    *   `允许的 IP` 和 `地址` 会自动从服务器网段分配。
4.  **导出配置**：
    *   **二维码**：点击“生成二维码”，使用手机 WireGuard App 扫码即可连接。
    *   **配置文件**：点击“导出配置文件”，将 `.conf` 文件发送给电脑端使用。

---

## 6. 高级功能

### MTU 优化向导
*   **入口**：仪表盘 -> MTU 优化器。
*   **作用**：检测链路的最佳 MTU 值，避免数据包分片导致的性能下降。
*   **使用**：输入目标主机（如 `8.8.8.8` 或服务器公网 IP），点击“开始评估”。完成后可一键应用推荐值。

### 动态 IP 同步
*   **入口**：设置 -> 自动化 -> 启用动态 IPv6 端点同步。
*   **作用**：如果您的宽带公网 IPv6 地址经常变动，开启此功能后，程序会自动监测并更新配置，确保客户端不掉线。

### 启动页优化
*   程序启动时会显示全新的 Splash Screen，并在后台预加载核心组件，确保进入主界面时流畅无卡顿。

---

## 7. 常见问题 (FAQ)

**Q: 客户端显示已连接，但无法上网？**
A: 请检查：
1.  服务器端的 NAT 或 Internet 共享是否已启用（显示为绿色勾选）。
2.  路由器是否已正确转发 UDP 端口（默认 51820）。
3.  Windows 防火墙是否放行了 WireGuard。

**Q: 点击“隧道”页面时有卡顿？**
A: 最新版本已通过单例模式 (Singleton) 优化了页面加载机制，首次加载后再次点击将瞬间切换。

**Q: 如何卸载？**
A: 在“隧道”页面中，先点击“卸载隧道服务”，然后通过 Windows 设置中的“应用和功能”卸载主程序。

---
*文档版本: 2026.02.12 | 适用于 Wg Server for Windows v2.2+*
